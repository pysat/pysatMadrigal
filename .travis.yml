language: python
dist: xenial
jobs:
  include:
    - name: '3.7 with flake8'
      python: '3.7'
      script:
          - flake8 . --count --select=E,F,W
          - pytest --cov=pysatMadrigal/
    - python: '3.8'
      script: pytest --cov=pysatMadrigal/
    - python: '3.9'
      script: pytest --cov=pysatMadrigal/

services: xvfb
cache: pip

addons:
  apt:
    packages:
    - gfortran
    - libncurses5-dev

before_install:
  - python -m pip install --upgrade pip
  # Get the program and testing requirements
  - pip install -r test_requirements.txt
  - pip install -r requirements.txt
  # set up data directory
  - mkdir /home/travis/build/pysatData
  - python -c "import pysat; pysat.params['data_dirs'] = '/home/travis/build/pysatData'"
install:
  - python setup.py install

after_success:
 - coveralls --rcfile=setup.cfg
